<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Google Maps Simples</title>
    <style>
        body { margin: 0; font-family: Arial, sans-serif; }
        #map { height: 80vh; width: 100%; }
        #search-box { padding: 10px; text-align: center; background: #f5f5f5; }
        input { width: 60%; padding: 8px; }
        button { padding: 8px 12px; }
    </style>
</head>
<body>

<div id="search-box">
    <input type="text" id="endereco" placeholder="Digite um endereço" />
    <button onclick="buscarEndereco()">Buscar</button>
</div>
<div id="map"></div>

<script>
    let map;
    let geocoder;

    function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
            center: { lat: -23.5505, lng: -46.6333 }, // São Paulo
            zoom: 12,
        });

        geocoder = new google.maps.Geocoder();

        // Tenta obter localização do utilizador
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const pos = {
                        lat: position.coords.latitude,
                        lng: position.coords.longitude,
                    };
                    map.setCenter(pos);
                    new google.maps.marker.AdvancedMarkerElement({
                        position: pos,
                        map: map,
                        title: "Você está aqui!",
                    });
                },
                (error) => {
                    console.error("Erro ao obter localização do utilizador:", error);
                    // Trata o erro de geolocalização (ex: exibir mensagem amigável)
                    alert("Não foi possível obter a sua localização. A busca será centralizada em São Paulo.");
                }
            );
        }
    }

    function buscarEndereco() {
        const endereco = document.getElementById("endereco").value;
        if (!endereco.trim()) {
            alert("Por favor, digite um endereço para buscar.");
            return; // Impede a busca com uma string vazia
        }
        geocoder.geocode({ address: endereco }, (results, status) => {
            if (status === google.maps.GeocoderStatus.OK) {
                map.setCenter(results[0].geometry.location);
                new google.maps.marker.AdvancedMarkerElement({
                    map: map,
                    position: results[0].geometry.location,
                });
            } else {
                alert("Geocode falhou: " + status + ". Verifique o endereço e tente novamente.");
            }
        });
    }
</script>

<script async
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAh26oPSRcCco71MLiIdcQsjyxg2M6er-I&callback=initMap&libraries=marker">
</script>

</body>
</html>
